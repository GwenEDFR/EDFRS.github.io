
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="All methods related to import data from files">
      
      
        <meta name="author" content="Gwen ADOLPHE <gwen.adolphe@edf-re.de>">
      
      
      
        <link rel="prev" href="../../../user_guide/dev_guide/add_project/">
      
      
        <link rel="next" href="../export_kpi/">
      
      
      <link rel="icon" href="../../../img/favicon.ico">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.5.25">
    
    
      
        <title>Import KPI - KPI monthly report.doc</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.6543a935.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Arial:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Arial";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="green" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#import-kpi" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="KPI monthly report.doc" class="md-header__button md-logo" aria-label="KPI monthly report.doc" data-md-component="logo">
      
  <img src="../../../image/logo_edf-renewables_WHITE.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            KPI monthly report.doc
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Import KPI
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="KPI monthly report.doc" class="md-nav__button md-logo" aria-label="KPI monthly report.doc" data-md-component="logo">
      
  <img src="../../../image/logo_edf-renewables_WHITE.png" alt="logo">

    </a>
    KPI monthly report.doc
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Project Overview
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Project Overview
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user_guide/architecture/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Architecture
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user_guide/Data/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Data How it's work ?
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user_guide/Getting_start/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Install environment
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user_guide/virtual_env/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Virtual environment
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_5" >
        
          
          <label class="md-nav__link" for="__nav_2_5" id="__nav_2_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Developer Guide
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_5">
            <span class="md-nav__icon md-icon"></span>
            Developer Guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user_guide/dev_guide/add_kpi/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Add KPI
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user_guide/dev_guide/add_project/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    How to add a project in your report
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Libraries
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Libraries
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1" checked>
        
          
          <label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    KPI_lib
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_1">
            <span class="md-nav__icon md-icon"></span>
            KPI_lib
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Import KPI
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Import KPI
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#dependencies" class="md-nav__link">
    <span class="md-ellipsis">
      Dependencies
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#summary" class="md-nav__link">
    <span class="md-ellipsis">
      Summary
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#import_data" class="md-nav__link">
    <span class="md-ellipsis">
      import_data
    </span>
  </a>
  
    <nav class="md-nav" aria-label="import_data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#initself-project-year-none" class="md-nav__link">
    <span class="md-ellipsis">
      init(self, project, year) -&gt; None
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mainself-data_path" class="md-nav__link">
    <span class="md-ellipsis">
      main(self, data_path)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datetime_columnsself-df" class="md-nav__link">
    <span class="md-ellipsis">
      datetime_columns(self, df)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#import_csv_grafanaself-data_path" class="md-nav__link">
    <span class="md-ellipsis">
      import_csv_grafana(self, data_path)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#import_csv_smartblueself-data_path" class="md-nav__link">
    <span class="md-ellipsis">
      import_csv_smartblue(self, data_path)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#xlsx_to_csvself-data_path" class="md-nav__link">
    <span class="md-ellipsis">
      xlsx_to_csv(self, data_path)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#transform_df_tannself-df" class="md-nav__link">
    <span class="md-ellipsis">
      transform_df_TANN(self, df)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spec_wern_lmsself-file_path" class="md-nav__link">
    <span class="md-ellipsis">
      spec_WERN_LMS(self, file_path)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#transform_data_brem_wernself-df" class="md-nav__link">
    <span class="md-ellipsis">
      transform_data_BREM_WERN(self, df)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#class-import_e2m_data" class="md-nav__link">
    <span class="md-ellipsis">
      Class import_E2M_data
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Class import_E2M_data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#__init__self-project-year-none" class="md-nav__link">
    <span class="md-ellipsis">
      __init__(self, project, year) -&gt; None
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mainself" class="md-nav__link">
    <span class="md-ellipsis">
      main(self)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#import_csvself" class="md-nav__link">
    <span class="md-ellipsis">
      import_csv(self)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#transform_dataself-df" class="md-nav__link">
    <span class="md-ellipsis">
      transform_data(self, df)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datetime_columnsself-df_1" class="md-nav__link">
    <span class="md-ellipsis">
      datetime_columns(self, df)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#import_price_fcr" class="md-nav__link">
    <span class="md-ellipsis">
      import_price_FCR
    </span>
  </a>
  
    <nav class="md-nav" aria-label="import_price_FCR">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#__init__self-none" class="md-nav__link">
    <span class="md-ellipsis">
      __init__(self) -&gt; None
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get_priceself" class="md-nav__link">
    <span class="md-ellipsis">
      get_price(self)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#import_dataself" class="md-nav__link">
    <span class="md-ellipsis">
      import_data(self)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#transform_dataself-xl" class="md-nav__link">
    <span class="md-ellipsis">
      transform_data(self, xl)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../export_kpi/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Export KPI
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../hlz/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HLZ
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_4" >
        
          
          <label class="md-nav__link" for="__nav_3_1_4" id="__nav_3_1_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    KPI
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_4">
            <span class="md-nav__icon md-icon"></span>
            KPI
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../kpi_py/basic_kpi_class/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Basic KPI
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../kpi_py/fcr_class/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FCR
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../kpi_py/kpi_fig-class/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    KPI fig
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../kpi_plot/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Plot KPIs
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    PDF_Report_lib
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            PDF_Report_lib
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../pdf_report_lib/bess_report/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    BESS Report
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3" >
        
          
          <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    UI library
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            UI library
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../UI_lib/UI_tools/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    UI tools
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../UI_lib/UI_project/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    UI for project
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    About
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            About
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1" >
        
          
          <label class="md-nav__link" for="__nav_4_1" id="__nav_4_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Issues
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1">
            <span class="md-nav__icon md-icon"></span>
            Issues
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../About/issues/lib_issues.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Library Issues
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../About/release_notes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Release Notes
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../none.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    404
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#dependencies" class="md-nav__link">
    <span class="md-ellipsis">
      Dependencies
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#summary" class="md-nav__link">
    <span class="md-ellipsis">
      Summary
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#import_data" class="md-nav__link">
    <span class="md-ellipsis">
      import_data
    </span>
  </a>
  
    <nav class="md-nav" aria-label="import_data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#initself-project-year-none" class="md-nav__link">
    <span class="md-ellipsis">
      init(self, project, year) -&gt; None
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mainself-data_path" class="md-nav__link">
    <span class="md-ellipsis">
      main(self, data_path)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datetime_columnsself-df" class="md-nav__link">
    <span class="md-ellipsis">
      datetime_columns(self, df)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#import_csv_grafanaself-data_path" class="md-nav__link">
    <span class="md-ellipsis">
      import_csv_grafana(self, data_path)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#import_csv_smartblueself-data_path" class="md-nav__link">
    <span class="md-ellipsis">
      import_csv_smartblue(self, data_path)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#xlsx_to_csvself-data_path" class="md-nav__link">
    <span class="md-ellipsis">
      xlsx_to_csv(self, data_path)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#transform_df_tannself-df" class="md-nav__link">
    <span class="md-ellipsis">
      transform_df_TANN(self, df)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spec_wern_lmsself-file_path" class="md-nav__link">
    <span class="md-ellipsis">
      spec_WERN_LMS(self, file_path)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#transform_data_brem_wernself-df" class="md-nav__link">
    <span class="md-ellipsis">
      transform_data_BREM_WERN(self, df)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#class-import_e2m_data" class="md-nav__link">
    <span class="md-ellipsis">
      Class import_E2M_data
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Class import_E2M_data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#__init__self-project-year-none" class="md-nav__link">
    <span class="md-ellipsis">
      __init__(self, project, year) -&gt; None
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mainself" class="md-nav__link">
    <span class="md-ellipsis">
      main(self)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#import_csvself" class="md-nav__link">
    <span class="md-ellipsis">
      import_csv(self)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#transform_dataself-df" class="md-nav__link">
    <span class="md-ellipsis">
      transform_data(self, df)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datetime_columnsself-df_1" class="md-nav__link">
    <span class="md-ellipsis">
      datetime_columns(self, df)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#import_price_fcr" class="md-nav__link">
    <span class="md-ellipsis">
      import_price_FCR
    </span>
  </a>
  
    <nav class="md-nav" aria-label="import_price_FCR">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#__init__self-none" class="md-nav__link">
    <span class="md-ellipsis">
      __init__(self) -&gt; None
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get_priceself" class="md-nav__link">
    <span class="md-ellipsis">
      get_price(self)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#import_dataself" class="md-nav__link">
    <span class="md-ellipsis">
      import_data(self)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#transform_dataself-xl" class="md-nav__link">
    <span class="md-ellipsis">
      transform_data(self, xl)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="import-kpi">Import KPI</h1>
<h2 id="dependencies">Dependencies</h2>
<table>
<thead>
<tr>
<th>Librairies</th>
<th>version</th>
</tr>
</thead>
<tbody>
<tr>
<td>pandas</td>
<td>2.2.1</td>
</tr>
<tr>
<td>datetime</td>
<td>-</td>
</tr>
<tr>
<td>os</td>
<td>-</td>
</tr>
</tbody>
</table>
<h2 id="summary">Summary</h2>
<p>Class for importing data from csv file and formating it for the use of this code.\
<strong>class_name</strong> : import_data, import_E2M_data, import_price_FCR</p>
<h2 id="import_data">import_data</h2>
<h3 id="initself-project-year-none"><strong>init</strong>(self, project, year) -&gt; None</h3>
<p>Initialize the import_data class.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>
<p><code>self</code> (self): General information</p>
</li>
<li>
<p><code>project</code> (str): The project name.</p>
</li>
<li>
<p><code>year</code> (str): The year of the project.</p>
</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><code>None</code> (None): No return value.</li>
</ul>
<p><strong>Example:</strong></p>
<pre><code class="language-python"># Create an instance of the class
obj = import_data(project=&quot;example_project&quot;, year=&quot;2022&quot;)

# Access the attributes
print(&quot;project:&quot;, obj.project)
print(&quot;year:&quot;, obj.year)
print(&quot;year_short:&quot;, obj.year_short)
</code></pre>
<h3 id="mainself-data_path">main(self, data_path)</h3>
<p>Method to import data and format it.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><code>self</code> (self): General information</li>
<li><code>data_path</code> (str): The path to the data file.</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><code>df</code> (df): DataFrame with all formatted data.</li>
</ul>
<p><strong>Example:</strong></p>
<pre><code class="language-python"># Create an instance of the class
obj = import_data(project=&quot;example_project&quot;, year=&quot;2022&quot;)

# Call the main method with the data path
data_path = &quot;path/to/data.csv&quot;
formatted_data = obj.main(data_path)

# Print the formatted data
print(formatted_data)
</code></pre>
<h3 id="datetime_columnsself-df">datetime_columns(self, df)</h3>
<p>Method to add all datetime information in the df.\
This format can be add only if column 'Date' in a format datetime is in the df in input.\
Will add :</p>
<ul>
<li>
<p>the <strong>month</strong> (in number, ex: 01 for january)\</p>
</li>
<li>
<p>the <strong>week</strong> (in number, ex: 45 of this year)\</p>
</li>
<li>
<p>the <strong>day</strong> (in number, ex: 18 of march)\</p>
</li>
<li>
<p>the <strong>time</strong> (in number, ex: 18:25:35 for hours:minutes:seconde)\</p>
</li>
<li>
<p>the <strong>Date day</strong> (in number, ex: 2024-02-18 for the 18th of february 2024)\</p>
</li>
<li>
<p>the <strong>Week day</strong> (in number, ex 5 for saturday)\</p>
</li>
<li>
<p>the <strong>year</strong> (in number, ex: 2024)\</p>
</li>
</ul>
<p><strong>Parameters:</strong></p>
<ul>
<li>
<p><code>self</code> (self): General information.</p>
</li>
<li>
<p><code>df</code> (df): Dataframe with all formatted data.</p>
</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><code>df</code> (df): DataFrame with all formatted data.</li>
</ul>
<p><strong>Example:</strong></p>
<pre><code class="language-python"># Create an instance of the class
obj = import_data(project=&quot;example_project&quot;, year=&quot;2022&quot;)

# Call the method with the dataframe 
df_with_time_columns = obj.datetime_columns(df)

# Print the formatted data
print(df_with_time_columns)
</code></pre>
<h3 id="import_csv_grafanaself-data_path">import_csv_grafana(self, data_path)</h3>
<p>Method to import data from a CVS. For Grafana data.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><code>self</code> (self): General information.</li>
<li><code>data_path</code> (str): The path to the CSV file(s).</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><code>df</code> (df): DataFrame with all formatted data.</li>
</ul>
<p><strong>Example:</strong></p>
<pre><code class="language-python"># Create an instance of the class
obj = import_data(project=&quot;example_project&quot;, year=&quot;2022&quot;)

# Call the import_csv method with the data path
data_path = &quot;path/to/data.csv&quot;
formatted_data = obj.import_csv_grafana(data_path)

# Print the formatted data
print(formatted_data)
</code></pre>
<h3 id="import_csv_smartblueself-data_path">import_csv_smartblue(self, data_path)</h3>
<p>Method to import data from a CVS. For smartblue data.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><code>self</code> (self): General information.</li>
<li><code>data_path</code> (str): The path to the CSV file(s).</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><code>df</code> (df): DataFrame with all formatted data.</li>
</ul>
<p><strong>Example:</strong></p>
<pre><code class="language-python"># Create an instance of the class
obj = import_data(project=&quot;example_project&quot;, year=&quot;2022&quot;)

# Call the import_csv_smartblue method with the data path
data_path = &quot;path/to/data.csv&quot;
formatted_data = obj.import_csv_smartblue(data_path)

# Print the formatted data
print(formatted_data)
</code></pre>
<h3 id="xlsx_to_csvself-data_path">xlsx_to_csv(self, data_path)</h3>
<p>Transform .xlsx/.xls file in .csv and then delete the .xlsx file.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><code>self</code> (self): General information.</li>
<li><code>data_path</code> (str): Path where to find the file to replace.</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><code>none</code></li>
</ul>
<p><strong>Example:</strong></p>
<pre><code class="language-python"># Create an instance of the class
obj = import_data(project=&quot;example_project&quot;, year=&quot;2022&quot;)

# Call the method with the dataframe 
obj.xlsx_to_csv(data_path)

# No output 
</code></pre>
<h3 id="transform_df_tannself-df">transform_df_TANN(self, df)</h3>
<p>Module to normalize data from TANN to be used by this code.\
Add 0 to all 'aux 1', 'aux 2', 'aux 3', 'availability', '15 min data', 'permissible power', '[L]', '[AP2]', 'BESS power', '15mn average power', '15s average power', 'P', 'LMS request discharge' column (fake data).\
Add the two max on and off peak of this project (enter manually).\
Format energy in cumulative energy for the year, indeed the energy meter of Tanne reset every day that is not convenient for the computation of our KPIs.\</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><code>self</code> (self): General information.</li>
<li><code>df</code> (df): DataFrame with all formatted data.</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><code>df</code> (df): DataFrame with all formatted data.</li>
</ul>
<p><strong>Example:</strong></p>
<pre><code class="language-python"># Create an instance of the class
obj = import_data(project=&quot;example_project&quot;, year=&quot;2022&quot;)

# Call the method with the dataframe 
formatted_df = obj.transform_df_TANN(df)

# Print the formatted data
print(formatted_df)
</code></pre>
<h3 id="spec_wern_lmsself-file_path">spec_WERN_LMS(self, file_path)</h3>
<p>Module to import data from a CSV file from the LMS in project WERN.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>
<p><code>self</code> (self): General information.</p>
</li>
<li>
<p><code>file_path</code> (str): Path of the file 'Wernigerode_15min_data_export.csv'.</p>
</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><code>df</code> (df): DataFrame with all formalized data.</li>
</ul>
<p><strong>Example:</strong></p>
<pre><code class="language-python"># Create an instance of the class
obj = import_data(project=&quot;WERN&quot;, year=&quot;2022&quot;)

# Specify the file path
file_path = 'path/to/Wernigerode_15min_data_export.csv'

# Call the spec_WERN_LMS method and pass the 'file_path' as an argument
result = obj.spec_WERN_LMS(file_path)

# Print the imported data as a DataFrame
print(result)
</code></pre>
<h3 id="transform_data_brem_wernself-df">transform_data_BREM_WERN(self, df)</h3>
<p>Module to normalize data from BREM and WERN to be used by this code.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>
<p><code>self</code> (self): General information.</p>
</li>
<li>
<p><code>df</code> (df): DataFrame with all formalized data.</p>
</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><code>df</code> (df): DataFrame with all formalized data.</li>
</ul>
<p><strong>Example:</strong></p>
<pre><code class="language-python"># Create an instance of the class
obj = import_data(project=&quot;BREM&quot;, year=&quot;2022&quot;)

# Create a sample dataframe 'df' with formalized data
df = pd.DataFrame({
    'availability': [1, 1, 0, 1, 0],
    'other_column': [10, 20, 30, 40, 50]
    ...
})

# Call the transform_data_BREM_WERN method and pass the 'df' as an argument
result = obj.transform_data_BREM_WERN(df)

# Print the updated 'df' dataframe with the normalized data
print(result)
</code></pre>
<h2 id="class-import_e2m_data">Class import_E2M_data</h2>
<h4 id="__init__self-project-year-none">__init__(self, project, year) -&gt; None</h4>
<p>Initialize the import_data class.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>
<p><code>project</code> (str): The project name.</p>
</li>
<li>
<p><code>year</code> (str): The year of the project.</p>
</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li>None</li>
</ul>
<p><strong>Example:</strong></p>
<pre><code class="language-python">from import_KPI import import_E2M_data
# Create an instance of the class
obj = import_E2M_data('ProjectName', '2022')

# Access the project and year attributes
print(obj.project)
print(obj.year)
</code></pre>
<h3 id="mainself">main(self)</h3>
<p>Module to import data and format it.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><code>self</code> (self): General information.</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><code>df</code> (df): DataFrame with all formalized data.</li>
</ul>
<p><strong>Example:</strong></p>
<pre><code class="language-python">from import_KPI import import_E2M_data
# Create an instance of the class
obj = import_E2M_data('ProjectName', '2022')

# Call the main method
result = obj.main()

# Print the formatted data DataFrame
print(result)
</code></pre>
<h3 id="import_csvself">import_csv(self)</h3>
<p>Module to import data from a CSV file.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><code>self</code> (self): General information.</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><code>df</code> (df): DataFrame with all formalized data.</li>
</ul>
<p><strong>Example:</strong></p>
<pre><code class="language-python">from import_KPI import import_E2M_data
# Create an instance of the class
obj = import_E2M_data('ProjectName', '2022')

# Call the import_csv method
result = obj.import_csv()

# Print the imported data as a DataFrame
print(result)
</code></pre>
<h3 id="transform_dataself-df">transform_data(self, df)</h3>
<p>Module to transform data.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><code>self</code> (self): General information.</li>
<li><code>df</code> (df): DataFrame with all formalized data.</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><code>df</code> (df): DataFrame with all formalized data.</li>
</ul>
<p><strong>Example:</strong></p>
<pre><code class="language-python">from import_KPI import import_E2M_data
# Create an instance of the class
obj = import_E2M_data('ProjectName', '2022')

# Call the import_csv method to get the initial DataFrame
df = obj.import_csv()

# Call the transform_data method
df_transformed = obj.transform_data(df)

# Print the transformed DataFrame
print(df_transformed)
</code></pre>
<h3 id="datetime_columnsself-df_1">datetime_columns(self, df)</h3>
<p>Module to add datetime columns to the DataFrame.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><code>self</code> (self): General information.</li>
<li><code>df</code> (df): DataFrame with all formalized data.</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><code>df</code> (df): DataFrame with all formalized data.</li>
</ul>
<p><strong>Example:</strong></p>
<pre><code class="language-python">from import_KPI import import_E2M_data
# Create an instance of the class
obj = import_E2M_data('ProjectName', '2022')

# Call the import_csv method to get the initial DataFrame
df = obj.import_csv()

# Call the transform_data method
df_transformed = obj.transform_data(df)

# Call the datetime_columns method
df_with_datetime = obj.datetime_columns(df_transformed)

# Print the transformed DataFrame with datetime columns
print(df_with_datetime)
</code></pre>
<h2 id="import_price_fcr">import_price_FCR</h2>
<h3 id="__init__self-none">__init__(self) -&gt; None</h3>
<p>Initialize the import_price_FCR class.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>None</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li>None</li>
</ul>
<h3 id="get_priceself">get_price(self)</h3>
<p>Module to get the FCR price.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><code>self</code> (self): General information.</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><code>dict_price</code> (dict): Dictionary with FCR prices.</li>
</ul>
<p><strong>Example:</strong></p>
<pre><code class="language-python">from import_KPI import import_price_FCR
# Create an instance of the class
obj = import_price_FCR()

# Call the get_price method
price_list = obj.get_price()

# Print the FCR prices as a dictionary
print(price_list)
</code></pre>
<h3 id="import_dataself">import_data(self)</h3>
<p>Module to import data from an Excel file. Excel file found here : <C:\Users\******\EDF Renouvelables\EDF DS - Team Berlin - Dokumente\1. EDF DS\6.OPERATIONS\HYDRO-SPEIRA_Hamburg_211130\CONTRACTOR-SUPPLIER\FCR_e2m></p>
<blockquote>
<p>⚠️ File create by a human may have error/ name change. Need to be careful.
File identify by 'TRK' only to prevent change name. </p>
</blockquote>
<p><strong>Parameters:</strong></p>
<ul>
<li><code>self</code> (self): General information.</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><code>xl</code> (pd.ExcelFile): Excel file object.</li>
</ul>
<p><strong>Example:</strong></p>
<pre><code class="language-python"># Create an instance of the class
obj = import_price_FCR()

# Call the import_data method
result = obj.import_data()

# Print the Excel file object
print(result)
</code></pre>
<h3 id="transform_dataself-xl">transform_data(self, xl)</h3>
<p>Module to transform data from the Excel file.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>
<p><code>self</code> (self): General information.</p>
</li>
<li>
<p><code>xl</code> (pd.ExcelFile): Excel file object.</p>
</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><code>dict_price</code> (dict): Dictionary with transformed price data.</li>
</ul>
<p><strong>Example:</strong></p>
<pre><code class="language-python"># Create an instance of the class
obj = import_price_FCR()

# Call the import_data method to get the Excel file object
xl = obj.import_data()

# Call the transform_data method
result = obj.transform_data(xl)

# Print the transformed price data as a dictionary
print(result)
</code></pre>







  
  






                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": [], "search": "../../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.081f42fc.min.js"></script>
      
    
  </body>
</html>